Chap 1.12 函数与过程抽象
==================
作者：郭炜
时间：2015-07-12  

在编写程序时，完成某一功能的那段代码常常在很多地方都要使用。比如，用一段代码实现了一个求平方根的功能，对于一个复杂的科学计算程序来说，很可能有几十甚至上百处都需要求平方根。如果在每个需要求平方根的地方，都要把求平方根的那段代码重写一遍，不但程序员工作量无谓地增加许多，编译出来的可执行程序也会有大量的重复部分，浪费内存空间。能不能求平方根的代码只写一遍，就到处都可以使用呢？

高级语言几乎都提供了“函数”（function）这种机制，用来解决上述的问题。有些语言里将“函数”称为“过程”(procedure)。“函数”的作用之一就是可以将实现了某一功能，并需要反复使用的代码包装起来形成一个功能模块（即写成一个“函数”），那么当程序中需要使用该项功能时，就不需要将实现该功能的代码重写一遍，而是只需写一条语句，调用实现该功能的 “函数”即可。

实际上，函数的作用不仅仅是减少重复劳动。编写一个复杂的程序，要一下子全盘都想清楚怎么写是很难的，一般的思路就是将程序要解决的复杂的大问题，分解成多个相对简单的子问题，子问题又可以进一步分解更小的子子问题……最小的子问题就可以用一个函数来解决。复杂的程序少则几个人合作编写，多则上千人共同开发（如Windows操作系统），有了函数或其他类似的机制，才能使得分工合作成为可能。即便是一个人编写并不很复杂的程序，将问题层层划分成子问题并将子问题分别用不同的函数实现，也有利于编写程序时理清思路、发现错误时便于查找、以及日后自己或合作伙伴阅读程序时容易理解。


函数的定义和调用
---------------

###函数的定义

```cpp
C++中，函数的定义形式如下：
	
返回值类型 函数名(参数1类型  参数1名称,  参数2类型 参数2名称……)
{
		语句组

}
```

“返回值类型”就是具体的类型名，如int，double等。

函数名和参数名的命名规则和变量一样。好的函数的命名，应当做到能让人看到名字，就明白其功能大致是什么。括号“()”里面是参数表。参数之间用逗号隔开,各个参数的类型可以不同。参数表中的参数个数不限，也可以没有。即使没有参数，“()”也不能省略。“{}”及其内部的语句组合称为“函数体”。

C++函数有点类似于数学上的函数概念，参数相当于自变量，返回值相当于自变量映射到的值。C++函数的作用可以是根据参数计算出一个结果，但也可以不返回任何结果，只是在执行的过程中完成某一项功能(比如在屏幕上画一个圆)。

如果函数不需要返回值，则“返回值类型”可以写“void”。

当然函数也可以既计算出某个结果同时又完成某项功能。


###函数调用和return语句

对函数的调用形式如下：

```
函数名（参数1,参数2，……）
```

对函数的调用，也是一个表达式。函数调用表达式的值，由函数内部的return语句决定。return语句语法如下：
 
```
return 返回值；
```

return语句的功能是结束函数的执行，并将“返回值”作为结果返回。“返回值”是常量、变量或复杂的表达式均可。如果函数返回值类型为“void”，return语句就直接写：

```
return ;
```

此时不需要也不能写“返回值”了。

return 语句作为函数的出口，可以在函数中多次出现。多个return语句的“返回值”可以不同。在哪个return语句结束函数的执行，函数的返回值就和哪个return语句里面的“返回值”相等。


###函数使用实例



下面是一个函数的定义：

```cpp
int Max(int x,int y)
{
 	if( x > y )
 		return x;
    return y;
}
```

这个函数名为“Max”，其功能是返回两个参数x,y里面比较大的那个。参数在函数内部就相当于一个变量。函数内部还可以定义其他变量。函数定义中的参数，如上面的x,y，一般称为“形式参数”，简称“形参”。
下面这条语句调用了Max函数，将5和a两者较大的那个取出来放到变量n里面(假定a是个int型变量)：

int n = Max(5,a);

在上面的语句中，调用函数时给的参数，如5和a，被称为“实际参数”，简称“实参”。实参可以是常量、变量或复杂的表达式。C++要求调用函数时，实参的个数和类型以及先后次序要和函数定义中的形参匹配；如果用函数的返回值给某个变量赋值，那么该变量的类型应该和函数的返回值类型匹配。

函数调用语句被执行时，程序会跳转到函数内部的代码运行。刚进入函数内部时，形参的值就等于实参的值。形参的值在函数执行过程中也允许被修改。如上面的int n = Max(5,a)执行时进入Max函数内部，那么x的值就等于5,y的值就等于a的值。函数执行过程中碰到return语句，就会不再执行return后面的语句，立即从函数里跳出来回到调用语句处继续执行。在上面的例子里，Max函数返回x,y中较大的那个，返回值被存放到变量n里。

因为函数调用本身也是一个表达式，所以“int n = Max(5,a) + 7; ”这样的语句也是合法的。
再看一个判断整数n是否是素数的函数的例子。该函数返回值是bool类型的，如果实参是个素数，就返回true,否则返回false。

```cpp
bool IsPrime(int n)
{
 	 if( n <= 1 ) 
			return false;
		 for( int i = 2;i < n; ++i )  //看看有没有n的因子
		 	  if( n % i == 0 )
 	 	  	  return false;
 	 return true;
}
```


可以看到，IsPrime函数中return语句出现了多次。运行到return语句时，函数立即就会返回。

其实上面的程序可以改进，不用从2试到n-1,试到n的平方根即可。

调用一个函数时，并非一定要使用其返回值。假设有如下函数DrawCirle：

```cpp
double DrawCircle(double x,double y,double r)
{
		//下面的代码在屏幕上以(x,y)点为圆心，r为半径画圆
		……… 
		………. 
		return 3.1415926 * r * r;
}
```

上面的函数能够在屏幕上画一个圆，并且返回该圆的面积。如果只想画圆而不关心其面积的话，调用该函数时就不用处理其返回值，可以只写：

```
DrawCircle(0,0,1);
```
