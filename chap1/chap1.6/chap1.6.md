Chap1.6 一维数组
==================
作者：郭炜,摘自其编著《新标准C++程序设计》
时间：2015-07-14  


想想如何编写下面的程序：

接收键盘输入的100个整数，然后将它们按从小到大的顺序输出。

要编写这个程序，首先要解决的问题就是：如何存放这100个整数？直观的想法是定义100个int型变量，n1, n2, n3 ……n100，用来存放这100个整数。可这样的想法真让人受不了。

幸好，C++语言中“数组”的概念，为我们解决上述问题提供了很好的办法。实际上，几乎所有的高级程序设计语言，都支持数组。数组可以用来表达类型相同的元素的集合，集合的名字就是数组名。数组里的元素都有编号，元素的编号叫下标。通过数组名和下标，就能访问元素。


一维数组
-----------------

在C++中，一维数组的定义方法如下：

类型名 数组名[元素个数]; 

其中“元素个数”必须是常量或常量表达式，不能是变量，而且其值必须是正整数。元素个数也称作“数组的长度”。例如：

```cpp
int a[100]; 
```

上面的语句就定义了一个名字为a的数组，它有100个元素，每个元素都是一个int型变量。我们可以用a这个数组来存放本章开头提到的程序所需要存储的100个整数。

一般地，如果我们写：

```cpp
T a[ N ];      //此处T可以是任何类型名，如char，double，int等。
	      //N是一个正整数，或值为正整数的常量表达式。 
```

那么，我们就定义了一个数组，这个数组的名字是a（名字可以换）。a数组里有N个元素，每个元素都是一个类型为T的变量。这N个元素在内存里是一个挨一个连续存放的。a数组占用了一片连续的、大小总共为 N × sizeof(T)字节的存储空间。

表达式“sizeof(a)”的值就是整个数组的体积，即N × sizeof(T)。


如何访问数组中的元素呢？实际上，每个数组元素都是一个变量，数组元素可以表示为以下形式：

数组名[下标]

其中下标可以是任何值为整型的表达式，该表达式里可以包含变量、函数调用。下标如为小数时，编译器将自动去尾取整。例如：如果a是一个数组的名字，i，j都是int型变量，那么

a[5]
a[i+j]
a[i++]

都是合法的数组元素。
在C++语言中，数组的“下标”是从0开始的。也就是说，如果有数组:

T a[N];

则a[N]中的N个元素，按地址从小到大的顺序，依次是a[0], a[1], a[2]……a[N-1]。a[i](i为整数)就是一个T类型的变量。如果 a[0]存放在地址 n, 那么a[i]就被存放在地址n + i×sizeof(T)。


如何访问数组中的元素呢？实际上，每个数组元素都是一个变量，数组元素可以表示为以下形式：

数组名[下标]

其中下标可以是任何值为整型的表达式，该表达式里可以包含变量、函数调用。下标如为小数时，编译器将自动去尾取整。例如：如果a是一个数组的名字，i，j都是int型变量，那么

a[5]
a[i+j]
a[i++]

都是合法的数组元素。
在C++语言中，数组的“下标”是从0开始的。也就是说，如果有数组:

T a[N];

则a[N]中的N个元素，按地址从小到大的顺序，依次是a[0], a[1], a[2]……a[N-1]。a[i](i为整数)就是一个T类型的变量。如果 a[0]存放在地址 n, 那么a[i]就被存放在地址n + i×sizeof(T)。


例题:筛法求素数。求10,000,000以内的所有素数。

判断一个数n是不是素数，可以用2到 之间的所有整数去除n，看能否整除。如果都不能整除，那么n是素数。求10,000,000以内的所有素数，可以对3至10,000,000中的每个数都重复上述过程，发现是素数则输出。

但是这样做比较慢，如果用空间换时间，设置一个大数组，用“筛法”求素数，则速度会提高一倍左右。筛法求素数的基本思想是：把2到10,000,000中所有的数都列出来，然后从2开始，先划掉10,000,000内所有2的倍数，然后每次从下一个剩下的数(必然是素数)开始，划掉其10,000,000内的所有倍数。最后剩下的数，就都是素数。程序如下：

```cpp
1.	#include <iostream>
2.	#include <cmath>
3.	using namespace std;
4.	const int MAX_NUM = 10000000;
5.	bool isPrime[MAX_NUM + 10]; //最终如果isPrime[i]为true，则表示i是素数
6.	int main()
7.	{
8.		for( int i = 2;i <= MAX_NUM; ++i) //开始假设所有数都是素数
9.			isPrime[i] = true;
10.		for( int i = 2;i <= MAX_NUM; ++i) { //每次将一个素数的所有倍数标记为非素数
11.			if( isPrime[i])  //只标记素数的倍数
12.				for( int j = 2 * i; j <= MAX_NUM; j += i)
13.					isPrime[j] = false; //将素数 i 的倍数标记为非素数
14.		}
15.		for( int i = 2;i <= MAX_NUM; ++i) 
16.			if( isPrime[i])
17.				cout << i << endl;
18.		return 0;
19.	}
```
第4行，在main函数外部定义了数组isPrime。在C++中，是可以在函数的外面定义变量的。定义在所有函数之外的变量，称为“全局变量”。定义在某个函数里面的变量，叫局部变量。全局变量可以被同一个.cpp文件中的所有函数所访问，局部变量只能在定义它的函数内部进行访问。mmmm





数组的大小限制
-------------------
在C++中，数组的大小是有限制的，各个编译器具体规定不同。比如在Dev C++中，数组所占的字节数最多不能超过0x7fffffff。

如果数组定义在一个函数内部，那么其大小是非常有限的(具体最大可以多大，各编译器有所不同)。因为函数内部的变量（数组也算是变量），即局部变量，都是在栈上分配空间的，而一个程序的栈，大小是比较有限的。在函数内部定义大数组，是初学者很容易犯的错误，很容易导致程序运行时因栈溢出而崩溃。下面这个程序，在main里定义了一个大数组，除此之外什么都没做。不论用Visual studio 2010编译，还是用Dev C++编译，该程序运行时都立即导致崩溃:

```cpp
#include <iostream>
using namespace std;
int main()
{
		int a[10000000];
		return 0;
}
```

所以，请记住，不要在函数内部定义大数组。要使用大数组，就将数组定义在所有函数之外,比如：

```cpp
#include <iostream>
using namespace std;
int a[10000000];
int main()
{
     for( int i = 0;i < 100;++i)
			cout << a[i] << endl;
		return 0;
}
```

定义在所有函数之外的变量，称为“全局变量”。各个函数中都可以访问全局变量。 

本节中提到的数组，其元素都是用数组名加一个下标就能表示出来。这样的数组称为一维数组。实际上，C++还支持二维数组乃至多维数组。二维数组中的每个元素，需要用两个下标才能表示。



